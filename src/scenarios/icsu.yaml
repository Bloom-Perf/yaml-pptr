scenarios:
  - name: 'creation_icv'
    browser: 'firefox'
    run: 'SEQUENTIAL'
    initialDelaySeconds: 0
    workers: 1
    iterations: 2
    actions:
      - type: GOTO
        url: 'https://icsu-performance.transilien.sncf.fr/icsu-web/index.html'
        options:
          waitUntil: 'domcontentloaded'

      - type: WAIT_FOR_SELECTOR
        selector: '#idToken1'
        options:
          visible: true
          timeout: 60000

      - type: TYPE
        selector: '#idToken1'
        text: 'PNBD09221'

      - type: WAIT_FOR_SELECTOR
        selector: '#idToken2'
        options:
          visible: true
          timeout: 60000

      - type: TYPE
        selector: '#idToken2'
        text: 'VDTq#x6B3xn0'

      - type: WAIT
        milliseconds: 5000

      - type: WAIT_FOR_SELECTOR
        selector: 'input[name="callback_3"]'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: 'input[name="callback_3"]'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//button[contains(@class, "openFilterButton")])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath(//button[contains(@class, "openFilterButton")])'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//span[contains(@class, "icon-expand-down")])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath(//span[contains(@class, "icon-expand-down")])'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//*[contains(translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "abcdefghijklmnopqrstuvwxyz"),"paris nord (ligne b)")])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath(//*[contains(translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "abcdefghijklmnopqrstuvwxyz"),"paris nord (ligne b)")])'

      - type: WAIT_FOR_SELECTOR
        selector: '#searchButton:not([disabled])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '#searchButton'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//td[contains(translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "abcdefghijklmnopqrstuvwxyz"),"qosguard")]/following-sibling::td//button[contains(., "Créer une ICV")])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath(//td[contains(translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "abcdefghijklmnopqrstuvwxyz"),"qosguard")]/following-sibling::td//button[contains(., "Créer une ICV")])'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//div[contains(@class, "spinner-identifiant") and contains(@class, "ng-hide")])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '#inputIdentifiant'
        options:
          clickCount: 3

      - type: EVALUATE
        script: 'document.querySelector("#inputIdentifiant").value = ""'

      - type: TYPE
        selector: '#inputIdentifiant'
        text: 'QosGuard-${CURRENT_DATE}'

      - type: WAIT_FOR_SELECTOR
        selector: '#selectedMotif .ui-select-placeholder'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '#selectedMotif .ui-select-placeholder'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath((//input[@type="radio"])[4])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath((//input[@type="radio"])[4])'

      - type: WAIT_FOR_SELECTOR
        selector: '#validateIcv'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '#validateIcv'

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//div[contains(@class, "loading-situation-container ng-scope") and contains(@class, "ng-hide")])'
        options:
          visible: true
          timeout: 60000

      - type: WAIT_FOR_SELECTOR
        selector: '::-p-xpath(//li[contains(@class, "cliquable")]/a[@ng-click="navigationCtrl.logout()"])'
        options:
          visible: true
          timeout: 60000

      - type: CLICK
        selector: '::-p-xpath(//li[contains(@class, "cliquable")]/a[@ng-click="navigationCtrl.logout()"])'

      - type: WAIT_FOR_TIMEOUT
        timeout: 10000

      - type: CLOSE
